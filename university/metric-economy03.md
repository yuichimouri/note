# OLS Estimators

**OLS: 最小二乗法**  
測定で得られた数値の組を、的渡欧なモデルから想定される1次関数、対数曲線など特定の関数を用いて近似する時に、想定する関数が測定値に対してより近似とな流ように、残差の二乗和を最小とするような係数を決定する方法。

## OLS推定量の統計的性質（期待値と分散）

### 重要なキーワード

* 推定量
  * 確率変数
  * 標本に基づく**数式**で表される
* 推定値
  * 推定量の実現値
  * 数式にデータを代入して得られる結果

### 重要な仮定

* SLR.1: 線形モデル
  * linear in parameters
* SLR.2: 無作為標本
  * random sampling
  * nは標本の大きさ。標本は塊のことを言うので1つ。
* SLR.3: 説明変数の変動
  * Sample variation in the explanatory variable
  * xの分散が0より大きい = 0ではない
  * xが共通であることはない
  * 「被説明変数yの変動」を「説明変数xの変動」で説明するので、xが変動しないのは設定ミス。
* SLR.4: 条件付き期待値0
  * Zero conditional mean
  * E(u|x) = 0
  * 0でない時、単純回帰モデルではない、多重回帰モデルを用いる必要がある

### 不遍性

* 「推定量の期待値」は「推定したかったパラメータ」に等しい
* 推定量の望ましい性質の一つ

#### 推定値がパラメータに近いか否かはわからない

* 1つの標本があれば1つの推定値が得られる。パラメータに近いかはわからない。
* 繰り返し標本抽出ができれば**推定量の標本分布**が得られる
* その平均のことを**最小二乗推定量の期待値**と呼ぶ
* これが推定したかったパラメータに等しいことが望ましい = 不偏性

#### 仮定SLR.1 - SLR.4の妥当性を確認することが重要

* 最小二乗推定量が不偏性をもつための仮定
* 不偏性を持っているので、この推定量を使う動機となる

#### 見せかけの相関

* xとyの間になんら因果関係がない場合でも見せかけの相関が生じることがある
* 仮定SLR.4が成り立たないときに生じ得る
* 例：
  * x = 水死した人の数
  * y = アイスクリームの売上
  * 誤差項 u には気温が含まれる


### 単純回帰モデル（SLR）のための仮定

#### SLR.5: 条件付き均一分散
* Conditional homoskedasticity
* Var(u|x) = σ^2
  * **xがどのように変化しても誤差項の分散は一定である**
* 成り立たない場合を考慮して分析する手法が現在は一般的

#### 条件付き不均一分散の典型例

* 賃金関数（説明変数 = 教育年数）
* 消費関数（説明変数 = 所得）
* log(y)を用いると均一分散に近づくことがある
  * log: 小さい変化を大げさに見せて、大きな変化を控えめに見せる
  * 不均一分散だったものが均一に近いものになることがある

### 分散が小さい（精度が高い）のは？

* 誤差項の分散Var(u) = σ^2が小さい時
  * 小さくしようと思ってもどうにかなるものではない
* 説明変数xの変動SST_xが大きい時（xの分散が大きい時）
  * より変動している説明変数
* 標本の大きさnが大きい時
  * データをたくさん集める

### 誤差項の分散の不偏推定

σ^2: SSR / df

* 自由度: degrees of freedom
  * df = n - 2
  * n - 2個の残差の値が決まれば、残りの2個の値は自動的に決まる
  * n - 2個の残差は自由に決まる
  * 残りの2個は制約によって自動的に決まる（自由でない）　


### 残差と誤差項

#### 残差

* 推定量と実現値との差である
* つまり、残差は0になるのがふさわしい。0になるような値を求めるのがそもそも。

#### 誤差項

* 説明変数が影響を与えるものでない
* β_0に含まれない
* 平均が0

### 誤差項の分散の不偏推定量の利用

* 回帰の標準誤差
* OLS推定量の分散の推定量
* OLS推定量の標準誤差